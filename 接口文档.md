# 交易系统API文档

## 目录
- [1. 对外接口](#1-对外接口)
  - [1.1 创建交易](#11-创建交易)
  - [1.2 查询单个交易](#12-查询单个交易)
  - [1.3 分页查询交易](#13-分页查询交易)
  - [1.4 查询所有交易](#14-查询所有交易)
  - [1.5 更新交易状态](#15-更新交易状态)
  - [1.6 删除交易](#16-删除交易)
  - [1.7 根据业务交易ID查询](#17-根据业务交易id查询)
- [2. 内部接口](#2-内部接口)
  - [2.1 清空所有交易数据](#21-清空所有交易数据)

## 1. 对外接口

所有对外接口的基础路径为：`/api/transactions`

### 1.1 创建交易

#### 接口描述
创建新的交易记录

#### 请求URL
```
POST /api/transactions/create
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明                                               |
|-------|------|---------|--------------------------------------------------|
| transId | String | 是 | 业务交易ID，全局唯一                                      |
| userId | String | 是 | 用户ID                                             |
| amount | BigDecimal | 是 | 交易金额，最小0.01                                      |
| description | String | 否 | 交易描述                                             |
| type | String | 是 | 交易类型，可选值：DEPOSIT（存款）、WITHDRAWAL（取款）、TRANSFER（转账） |

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Object | 交易对象 |
| data.id | Long | 交易记录ID |
| data.transId | String | 业务交易ID |
| data.userId | String | 用户ID |
| data.amount | BigDecimal | 交易金额 |
| data.type | String | 交易类型 |
| data.status | String | 交易状态 |
| data.createTime | String | 创建时间 |
| data.updateTime | String | 更新时间 |
| data.description | String | 交易描述 |

#### 请求示例
```bash
curl -X POST 'http://localhost:8080/api/transactions/create' \
-H 'Content-Type: application/json' \
-d '{
    "transId": "TX_001",
    "userId": "USER_001",
    "amount": 100.00,
    "description": "存款交易",
    "type": "DEPOSIT"
}'
```

### 1.2 查询单个交易

#### 接口描述
根据交易ID查询交易记录

#### 请求URL
```
GET /api/transactions/{id}
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明 |
|-------|------|---------|------|
| id | Long | 是 | 交易记录ID |

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Object | 交易对象（字段同创建接口） |

#### 请求示例
```bash
curl -X GET 'http://localhost:8080/api/transactions/123456'
```

### 1.3 分页查询交易

#### 接口描述
分页查询交易记录列表

#### 请求URL
```
GET /api/transactions/page
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明 |
|-------|------|---------|------|
| page | Integer | 否 | 页码，从0开始，默认0 |
| size | Integer | 否 | 每页记录数，默认10 |

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Object | 分页结果对象 |
| data.content | Array | 交易记录列表 |
| data.totalElements | Long | 总记录数 |
| data.pageNumber | Integer | 当前页码 |
| data.pageSize | Integer | 每页记录数 |
| data.totalPages | Integer | 总页数 |
| data.first | Boolean | 是否第一页 |
| data.last | Boolean | 是否最后一页 |

#### 请求示例
```bash
curl -X GET 'http://localhost:8080/api/transactions/page?page=0&size=10'
```

### 1.4 查询所有交易

#### 接口描述
查询所有交易记录

#### 请求URL
```
GET /api/transactions/all
```

#### 请求参数
无

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Array | 交易记录列表 |

#### 请求示例
```bash
curl -X GET 'http://localhost:8080/api/transactions/all'
```

### 1.5 更新交易状态

#### 接口描述
更新交易记录的状态

#### 请求URL
```
GET /api/transactions/{id}/update
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明                                                                               |
|-------|------|---------|----------------------------------------------------------------------------------|
| id | Long | 是 | 交易记录ID                                                                           |
| status | String | 是 | 新的交易状态，可选值：PENDING（待处理）、PROCESSING（处理中）、COMPLETED（已完成）、FAILED（失败）、CANCELLED（已取消） |
| description | String | 是 | 更新说明                                                                             |

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Object | 交易对象（字段同创建接口） |

#### 请求示例
```bash
curl -X GET 'http://localhost:8080/api/transactions/123456/update?status=PROCESSING&description=处理中'
```

### 1.6 删除交易

#### 接口描述
删除指定的交易记录

#### 请求URL
```
POST /api/transactions/{id}/delete
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明 |
|-------|------|---------|------|
| id | Long | 是 | 交易记录ID |

#### 响应数据
无响应体，HTTP状态码200表示成功

#### 请求示例
```bash
curl -X POST 'http://localhost:8080/api/transactions/123456/delete'
```

### 1.7 根据业务交易ID查询

#### 接口描述
根据业务交易ID查询交易记录

#### 请求URL
```
GET /api/transactions/trans/{transId}
```

#### 请求参数
| 参数名 | 类型 | 是否必须 | 说明 |
|-------|------|---------|------|
| transId | String | 是 | 业务交易ID |

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | Object | 交易对象（字段同创建接口） |

#### 请求示例
```bash
curl -X GET 'http://localhost:8080/api/transactions/trans/TX_001'
```

## 2. 内部接口

所有内部接口的基础路径为：`/inner/transactions`

### 2.1 清空所有交易数据

#### 接口描述
清空系统中的所有交易数据（仅用于测试环境）

#### 请求URL
```
POST /inner/transactions/clear
```

#### 请求参数
无

#### 响应数据
| 字段名 | 类型 | 说明 |
|-------|------|------|
| code | String | 响应码，000000表示成功 |
| data | null | 无数据返回 |

#### 请求示例
```bash
curl -X POST 'http://localhost:8080/inner/transactions/clear'
```

## 错误码说明

| 错误码 | 说明 | 级别 |
|-------|------|------|
| 000001 | 系统异常 | ERROR |
| 000002 | 参数错误 | INFO |
| 000003 | 未知错误 | ERROR |
| 100001 | 交易订单未找到 | ERROR |
| 100002 | 交易订单已存在 | WARN |
| 100003 | 更新操作时交易订单没有变更 | WARN |
| 100004 | 更新操作时状态变迁不合法 | ERROR | 